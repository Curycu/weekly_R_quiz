knitr::opts_chunk$set(echo = TRUE,comment=NA)
PieDonut(acs,aes(Dx,smoking))
require(moonBook)
require(moonBook)
require(ggplot2)
require(dplyr)
require(webr)
PieDonut(acs,aes(Dx,smoking))
PieDonut(acs,aes(Dx,smoking),explode=1)
PieDonut(acs,aes(Dx,smoking),explode=1,explodeDonut=TRUE)
knitr::opts_chunk$set(echo = TRUE,message=FALSE,warning=FALSE,comment=NA,out.width='70%',fig.align = 'center')
table(ace$Dx)
table(acs$Dx)
table(acs$Dx) %>% as.data.frame
df=table(acs$Dx) %>% as.data.frame
df
df=table(acs$Dx) %>% as.data.frame
colnames(df)="Dx"
df
pie <- data.frame(
state = c('eaten', 'eaten but said you didn\'t', 'cat took it',
'for tonight', 'will decompose slowly'),
focus = c(0.2, 0, 0, 0, 0),
start = c(0, 1, 2, 3, 4),
end = c(1, 2, 3, 4, 2*pi),
stringsAsFactors = FALSE
)
pie
pie <- data.frame(
state = c('eaten', 'eaten but said you didn\'t', 'cat took it',
'for tonight', 'will decompose slowly'),
start = c(0, 1, 2, 3, 4),
end = c(1, 2, 3, 4, 2*pi),
focus = c(0.2, 0, 0, 0, 0),
stringsAsFactors = FALSE
)
pie
df=table(acs$Dx) %>% as.data.frame
colnames(df)[1]="Dx"
df
data<-acs
pies="Dx"
donuts="smoking"
df=table(data[[pies]]) %>% as.data.frame
colnames(df)[1]=pies
df
explode=1
explodePos=0.1
r0=0
r1=1
df$end=cumsum(df$Freq)
df$start=dplyr::lag(df$end)
df$start[1]=0
total=sum(df$Freq)
df$start1=df$start*2*pi/total
df$end1=df$end*2*pi/total
df$start1=df$start1+start
df$end1=df$end1+start
df$start1=df$start*2*pi/total
df$end1=df$end*2*pi/total
df3=data.frame(table(data[[donuts]],data[[pies]]),stringsAsFactors = FALSE)
colnames(df3)[1:2]=c(donuts,pies)
a=table(data[[donuts]],data[[pies]])
df3$group=rep(colSums(a),each=nrow(a))
df3$pie=rep(1:ncol(a),each=nrow(a))
total=sum(df3$Freq)
df3$ratio1=df3$Freq/total
df3$ratio=scales::percent(df3$Freq/df3$group)
df3$end=cumsum(df3$Freq)
df3$start=dplyr::lag(df3$end)
df3$start[1]=0
df3$start1=df3$start*2*pi/total
df3$end1=df3$end*2*pi/total
df3$start1=df3$start1+start
df3$end1=df3$end1+start
df3$mid=(df3$start1+df3$end1)/2
df3$start[1]=0
df3$start1=df3$start*2*pi/total
df3$end1=df3$end*2*pi/total
df3$start1=df3$start1+start
